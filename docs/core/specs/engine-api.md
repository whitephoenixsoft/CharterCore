# ENG-API — Minimal Engine Interface Specification  
Status: FROZEN (v2 – Solo Mode Foundation + Rehydration)  
Applies to: Engine Core (V1 Solo Mode)  
Scope: Deterministic, storage-agnostic engine interface  

Authority: Subordinate to ENG-DOMAIN, ENG-ERROR, ENG-CORE-PURITY, ENG-REVIEW-RETIRED, ENG-SUPERSESSION  

---

# 1. Purpose

ENG-API defines the minimal deterministic interface between a host (CLI or other caller) and the Engine Core.

The Engine:

- Operates only on canonical domain objects  
- Generates all UUIDv7 identifiers internally  
- Emits structured EvaluationReports for every command  
- Emits audit events separately (append-only)  
- Never manages storage, indexing, import, or export  

Legitimacy is created **only** via session acceptance.

---

# 2. Global Rules

## ENG-API-01 — Deterministic Evaluation

Every API call must return exactly one:

EvaluationReport (see ENG-ERROR)

The Engine must not:

- Throw semantic exceptions
- Return booleans for legitimacy
- Encode meaning in narrative strings

---

## ENG-API-02 — UUID Ownership

All IDs are UUIDv7 generated by the Engine:

- session_id  
- candidate_id  
- resolution_id  
- evaluation_id  
- vote_id

The caller may reference existing IDs but may not create them.

---

## ENG-API-03 — No Implicit Legitimacy

No API call may:

- Create legitimacy outside acceptance
- Supersede resolutions directly
- Mutate immutable objects
- Auto-close sessions

Supersession occurs only as a consequence of successful acceptance.

---

# 3. Engine Rehydration & Status

## 3.1 rehydrate_engine

Load a complete area domain graph into memory for evaluation.

Inputs:

- domain_objects (sessions, candidates, votes, resolutions, scopes, annotations)

Behavior:

- Validates structural integrity, snapshots, supersession, participant sets, BLOCK_PERMANENT hygiene  
- Initializes in-memory evaluation context  
- Non-mutating with respect to storage

Returns:

- EvaluationReport summarizing readiness, invariant violations

---

## 3.2 list_sessions

Inputs:

- None (Engine operates on current rehydrated area)

Returns:

- Read-only session snapshots (session_id, state, phase, participant_ids, candidate_ids)

---

## 3.3 list_resolutions

Inputs:

- None

Returns:

- Read-only resolution snapshots (resolution_id, state, superseded_by, participant_snapshot, candidate_snapshot)

---

## 3.4 get_session_state

Inputs:

- session_id

Returns:

- Complete session object (phase, state, participants, candidates, votes, constraints, annotations)

---

## 3.5 get_resolution_state

Inputs:

- resolution_id

Returns:

- Complete resolution object

---

## 3.6 list_audit_events

Inputs:

- Optional filters (session_id, resolution_id, time range)

Returns:

- List of audit event references (audit_event_id, timestamp, type)

---

## 3.7 get_audit_event

Inputs:

- audit_event_id

Returns:

- Full audit event object (non-legitimizing)

---

# 4. Session Lifecycle

### (Same as previous spec, unchanged: create_session, pause_session, resume_session, close_session, participant management, candidate management, voting, attempt_acceptance)

---

# 5. Read-Only Evaluation

## 5.1 evaluate_session

Inputs:

- session_id

Behavior:

- Non-mutating  
- Returns EvaluationReport with acceptance feasibility, blocking conditions, constraint violations  
- Must not insert votes, mutate session, or emit legitimacy events

---

# 6. Import / Restore Support

## 6.1 validate_imported_area

Inputs:

- domain_objects (candidate import set)

Behavior:

- Read-only structural validation: object IDs, references, snapshots, supersession, constraints, participant sets  
- Detects conflicts, BLOCK_PERMANENT conditions, invariant violations  
- Returns EvaluationReport with success, REJECTED, or BLOCKED

---

## 6.2 simulate_restore

Inputs:

- domain_objects

Behavior:

- Non-mutating preview of post-restore state:  
  - Which sessions/resolutions would be ACCEPTABLE  
  - Potential BLOCK_TEMPORARY / BLOCK_PERMANENT conflicts  
  - Implicit solo-mode votes

Returns:

- EvaluationReport summarizing simulated outcome

---

# 7. Blocking Semantics

Blocking is never caller-initiated.

The Engine may transition a session to:

- BLOCK_TEMPORARY
- BLOCK_PERMANENT

Only as a consequence of invariant detection.

Caller cannot directly set block state.

---

# 8. Final Guarantees

- Supersession occurs only via session acceptance  
- Blocking is engine-detected, never caller-declared  
- Participants and candidates freeze at first vote  
- Solo mode is a degenerate voting case  
- All operations deterministic  
- All failures structured  
- Engine storage, import, and export remain caller responsibilities  
- CLI or host may rehydrate the engine each run with domain objects

---

# Mental Model

- Engine is a legitimacy compiler.  
- Sessions define context.  
- Votes define evaluation.  
- Acceptance defines legitimacy.  
- Rehydration loads the state of an area into memory.  
- Simulation and validation allow preview of imported or restored domain objects.  
- Everything else is preparation; nothing changes unless explicitly commanded.