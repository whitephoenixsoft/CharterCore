# ENG-API — Minimal Engine Interface Specification
Status: FROZEN (v7 – Single-Area Runtime Formalized)
Applies to: Engine Core (V1/V2+)
Scope: Deterministic, storage-agnostic engine interface

Authority: Subordinate to ENG-DOMAIN, ENG-ERROR, ENG-CORE-PURITY, ENG-REVIEW-RETIRED, ENG-SUPERSESSION, ENG-RECEIPT, ENG-INTEGRITY

---

# 1. Purpose

ENG-API defines the minimal deterministic interface between a host (CLI or other caller) and the Engine Core.

The Engine:

- Operates only on canonical domain objects
- Operates on exactly one Area at a time
- Generates all UUIDv7 identifiers internally
- Emits structured EvaluationReports for every command
- Emits audit events separately (append-only)
- Emits immutable session receipts at structural closure
- Never manages storage, indexing, import, or export
- Enforces governance slot invariants at command boundary

Legitimacy is created only via session acceptance.

Receipts formalize closure and are engine-authoritative artifacts.

Bootstrap is not a special API. Authority initialization occurs through standard session mechanics.

---

# 2. Global Rules

## ENG-API-00 — Single-Area Runtime Model

An Engine instance operates on exactly one Area at a time.

The Engine:

- Must not host multiple Areas simultaneously.
- Must not evaluate legitimacy across Areas.
- Must not retain legitimacy state from a previously loaded Area once a new Area is rehydrated.

Area switching is the responsibility of the host (e.g., CLI).

The host may change Areas by:

- Persisting the current Area state externally.
- Calling rehydrate_engine with the domain graph of another Area.

This is analogous to a "git checkout":

- The Engine loads one Area.
- Operates exclusively within it.
- Discards prior Area state upon rehydration.

Cross-area orchestration is strictly outside the Engine boundary.

---

## ENG-API-01 — Deterministic Command Reporting

Every mutating API call must return exactly one EvaluationReport.

Read-only calls return deterministic snapshots.

The Engine must not:

- Throw semantic exceptions
- Return booleans for legitimacy
- Encode meaning in narrative strings

All semantic outcomes must be structured.

---

## ENG-API-02 — UUID Ownership

All IDs are UUIDv7 generated by the Engine:

- session_id
- candidate_id
- resolution_id
- evaluation_id
- vote_id
- receipt_id

The caller may reference existing IDs but may not create them.

IDs are valid only within the currently loaded Area.

---

# 4. Engine Rehydration & Status

## 4.1 rehydrate_engine

Load a complete domain graph for a single Area into memory.

Inputs:

- domain_objects belonging to exactly one Area
  - sessions
  - candidates
  - votes
  - resolutions
  - scopes
  - receipts
  - annotations

Behavior:

- Replaces any previously loaded Area state
- Validates structural integrity
- Validates governance slot exclusivity
- Validates supersession graph
- Validates receipt integrity
- Validates participant sets
- Enforces BLOCK_PERMANENT hygiene
- Derives Area governance state (not stored)

Rehydration defines the active Area.

Non-mutating with respect to storage.

Fail if:

- Objects from multiple Areas are supplied
- Multiple ACTIVE Authority in the Area
- Multiple ACTIVE Scope in the Area
- Required slot missing given existing sessions
- Receipt content_hash mismatch
- Structural invariant violated