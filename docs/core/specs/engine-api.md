# ENG-API — Minimal Engine Interface Specification  
Status: FROZEN (v2 – Solo Mode Foundation)  
Applies to: Engine Core (V1 Solo Mode)  
Scope: Deterministic, storage-agnostic engine interface  

Authority: Subordinate to ENG-DOMAIN, ENG-ERROR, ENG-CORE-PURITY, ENG-REVIEW-RETIRED, ENG-SUPERSESSION  

---

# 1. Purpose

ENG-API defines the minimal deterministic interface between a host (CLI or other caller) and the Engine Core.

The Engine:

- Operates only on canonical domain objects  
- Generates all UUIDv7 identifiers internally  
- Emits structured EvaluationReports for every command  
- Emits audit events separately (append-only)  
- Never manages storage, indexing, import, or export  

Legitimacy is created **only** via session acceptance.

---

# 2. Global Rules

## ENG-API-01 — Deterministic Evaluation

Every API call must return exactly one:

EvaluationReport (see ENG-ERROR)

The Engine must not:

- Throw semantic exceptions
- Return booleans for legitimacy
- Encode meaning in narrative strings

---

## ENG-API-02 — UUID Ownership

All IDs are UUIDv7 generated by the Engine:

- session_id  
- candidate_id  
- resolution_id  
- evaluation_id  
- vote_id (if modeled explicitly)

The caller may reference existing IDs but may not create them.

---

## ENG-API-03 — No Implicit Legitimacy

No API call may:

- Create legitimacy outside acceptance
- Supersede resolutions directly
- Mutate immutable objects
- Auto-close sessions

Supersession occurs only as a consequence of successful acceptance.

---

# 3. Session Lifecycle

## 3.1 create_session

Create a new session.

Inputs:

- area_id (reference)
- authority_id (reference at creation)
- scope_id (reference at creation)
- participant_ids (set; must not be empty)
- constraints (optional)
- annotations (optional)

Behavior:

- Engine generates session_id (UUIDv7)
- Session phase = PRE_STANCE
- Session state = ACTIVE (unless invariant forces block)
- Participants mutable only during PRE_STANCE
- Authority and Scope snapshotted for session

Fail if:

- participant set is empty
- referenced authority or scope invalid
- area hygiene prevents session activation

Returns:

EvaluationReport

---

## 3.2 pause_session

Pause operational activity.

Inputs:

- session_id
- annotations (optional)

Allowed only if:

- state = ACTIVE

Transitions:

- ACTIVE → PAUSED

Returns:

EvaluationReport

---

## 3.3 resume_session

Resume a paused session.

Inputs:

- session_id
- annotations (optional)

Engine must revalidate:

- Authority still valid
- Scope still valid
- No permanent hygiene block

Transitions:

- PAUSED → ACTIVE  
- OR → BLOCK_TEMPORARY / BLOCK_PERMANENT (engine-detected)

Returns:

EvaluationReport

---

## 3.4 close_session

Explicitly terminate session without creating legitimacy.

Inputs:

- session_id
- annotations (optional)

Allowed only if:

- state ∉ {ACCEPTED, CLOSED}

Transitions:

- → CLOSED  
- phase → TERMINAL

Returns:

EvaluationReport

---

# 4. Participant Management (PRE_STANCE Only)

Participants may only be modified while:

- phase = PRE_STANCE
- state ∈ {ACTIVE, PAUSED}

---

## 4.1 add_participant

Inputs:

- session_id
- participant_id

Fail if:

- phase ≠ PRE_STANCE
- participant already exists

---

## 4.2 remove_participant

Inputs:

- session_id
- participant_id

Fail if:

- phase ≠ PRE_STANCE
- participant not present
- removal would produce empty participant set

---

# 5. Candidate Management (PRE_STANCE Only)

Candidates may only be modified while:

- phase = PRE_STANCE
- state ∈ {ACTIVE, PAUSED}

After first vote, phase transitions to VOTING and candidate set freezes.

---

## 5.1 add_candidate

Inputs:

- session_id
- content (opaque payload)
- annotations (optional)

Engine generates candidate_id (UUIDv7).

Fail if:

- phase ≠ PRE_STANCE

---

## 5.2 remove_candidate

Inputs:

- session_id
- candidate_id

Fail if:

- phase ≠ PRE_STANCE
- candidate not present

---

# 6. Voting

## 6.1 record_vote

Inputs:

- session_id
- participant_id
- candidate_id
- stance (ACCEPT | REJECT | ABSTAIN)
- annotations (optional)

Behavior:

- On first vote:
  - phase transitions PRE_STANCE → VOTING
  - candidate set and participant set freeze
- Vote objects immutable once recorded

Fail if:

- session not ACTIVE
- participant not in session
- candidate not in session
- state ∈ {PAUSED, BLOCK_TEMPORARY, BLOCK_PERMANENT, ACCEPTED, CLOSED}

---

# 7. Acceptance (Legitimacy Creation)

## 7.1 attempt_acceptance

This is the sole legitimacy-creating operation.

Inputs:

- session_id
- candidate_id
- annotations (optional)

Engine must:

1. Enforce area-wide BLOCK_PERMANENT hygiene  
2. Enforce session state = ACTIVE  
3. Enforce Authority rules  
4. Enforce constraints  
5. Evaluate votes deterministically  

---

### Solo Mode (V1)

V1 operates in Solo Governance Mode:

- Exactly one participant per session
- Authority rule effectively unanimous
- Voting not required explicitly

If:

- No vote exists at time of acceptance

Then:

- Engine inserts an implicit ACCEPT vote by sole participant
- Vote becomes part of immutable session snapshot
- Evaluation proceeds normally

No alternative acceptance path exists.

Solo mode is a degenerate case of the general voting model.

---

### On Success

Engine:

- Generates resolution_id (UUIDv7)
- Creates Resolution with:
  - authority_snapshot
  - scope_snapshot
  - participant_snapshot
  - candidate_snapshot
- Updates superseded resolution (if applicable)
- Transitions session:
  - state → ACCEPTED
  - phase → TERMINAL

Returns:

EvaluationReport (outcome = SUCCESS)

---

### On Failure

Engine returns:

EvaluationReport with:

- outcome = REJECTED or BLOCKED
- Deterministic error_code
- block_type if applicable

No mutation occurs on failure.

---

# 8. Read-Only Evaluation

## 8.1 evaluate_session

Inputs:

- session_id

Behavior:

- Non-mutating
- Returns structured EvaluationReport
- Indicates:
  - Whether acceptance conditions are satisfied
  - Any blocking conditions
  - Constraint violations

Must not:

- Insert votes
- Mutate session
- Emit legitimacy events

---

# 9. Blocking Semantics

Blocking is never caller-initiated.

The Engine may transition a session to:

- BLOCK_TEMPORARY
- BLOCK_PERMANENT

Only as a consequence of invariant detection.

Caller cannot directly set block state.

---

# 10. Audit Interaction

On successful mutations, the Engine emits audit events.

EvaluationReport may reference:

- audit_event_ids

But does not embed audit payloads.

Audit is append-only and non-legitimizing.

---

# 11. Final Guarantees

- Supersession occurs only via session acceptance.
- Blocking is engine-detected, never caller-declared.
- Participants and candidates freeze at first vote.
- Solo mode is a degenerate voting case, not a bypass.
- All operations deterministic.
- All failures structured.
- No storage, import, or export responsibilities exist in the Engine.

---

# Mental Model

The Engine is a legitimacy compiler.

Sessions define context.  
Votes define evaluation.  
Acceptance defines legitimacy.  
Everything else is preparation.